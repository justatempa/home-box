# 物品二维码功能使用说明

## 功能概述

每个物品都可以生成一个二维码，扫描二维码后可以查看物品的基础信息。二维码采用 URL 链接方式，支持公开访问。

## 主要特性

1. **动态更新**：二维码包含物品详情页链接，物品信息更新后，扫描同一个二维码会自动显示最新内容
2. **公开访问**：无需登录即可查看物品基础信息
3. **易于分享**：可以下载二维码图片或复制链接

## 使用方法

### 1. 生成二维码

1. 进入物品详情页
2. 切换到"更多信息"标签页
3. 点击"生成二维码"按钮
4. 系统会生成一个 300x300 像素的二维码图片

### 2. 下载和分享

生成二维码后，您可以：
- **下载二维码**：点击"下载二维码"按钮，保存为 PNG 图片
- **复制链接**：点击"复制链接"按钮，复制二维码对应的 URL
- **打印标签**：将下载的二维码图片打印并贴在实物上

### 3. 扫描查看

使用任何二维码扫描器（手机相机、微信扫一扫等）扫描二维码，会自动打开物品信息页面。

## 显示的信息

公开页面会显示以下物品信息：
- 物品名称
- 封面图片
- 分类
- 状态
- 获取方式
- 价格
- 评分
- 入库时间
- 标签
- 备注
- 所有者用户名

## 技术实现

### API 接口

#### 1. 生成二维码
```typescript
trpc.items.generateQRCode.useMutation({
  onSuccess: (data) => {
    // data.qrCodeDataUrl - base64 格式的二维码图片
    // data.qrUrl - 二维码对应的 URL
  }
})
```

#### 2. 获取公开信息
```typescript
// 公开接口，无需认证
const item = await api.items.getPublicInfo({ id: itemId });
```

### 二维码格式

- **内容**：`${NEXTAUTH_URL}/qr/${itemId}`
- **尺寸**：300x300 像素
- **容错级别**：M (Medium, 15%)
- **边距**：2 个模块

### 公开页面路由

- **路径**：`/qr/[id]`
- **访问权限**：公开（无需登录）
- **响应式设计**：适配移动端和桌面端

## 安全考虑

1. **数据隔离**：虽然是公开访问，但只显示基础信息，不包含敏感数据
2. **软删除保护**：已删除的物品无法通过二维码访问
3. **所有者信息**：仅显示用户名，不显示其他敏感信息

## 注意事项

1. 二维码生成后，即使物品信息更新，二维码本身不需要重新生成
2. 如果物品被删除，扫描二维码会显示 404 页面
3. 二维码图片为 base64 格式，可以直接下载或嵌入页面
4. 建议将二维码打印在防水标签上，贴在实物上便于管理

## 使用场景

- **家庭物品管理**：为家中物品贴上二维码，方便查找和管理
- **仓库管理**：为库存物品生成二维码，快速查看物品信息
- **资产管理**：为公司资产生成二维码，便于盘点和追踪
- **分享物品信息**：将二维码分享给他人，无需登录即可查看物品详情
